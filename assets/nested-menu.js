class NestedMenu extends HTMLElement{#e;#t;#s;#i;#o;#n;#u;#c;static#h=3;static#a=300;constructor(){super(),this.menu=this.querySelector("ul"),this.rows=Array.from(this.menu.querySelectorAll(":scope > li")),this.submenus=Array.from(this.menu.querySelectorAll(":scope > li > header-details-disclosure")),this.tolerance=this.getAttribute("tolerance")||0,this.submenuDirection=this.getAttribute("submenu-direction")||"right",this.#e=null,this.#u=[],this.#n=null,this.#c=null,this.#i=this.#l.bind(this),this.#s=this.#r.bind(this),this.#t=this.#m.bind(this),this.#o=this.#d.bind(this)}connectedCallback(){window.matchMedia&&!window.matchMedia("(any-hover: hover)").matches||(setTimeout((()=>{this.submenus.forEach((e=>{e.disableListeners()}))})),this.menu.addEventListener("mouseleave",this.#i),this.rows.forEach((e=>{e.addEventListener("mouseenter",this.#s),e.addEventListener("click",this.#t)})),document.addEventListener("mousemove",this.#o))}disconnectedCallback(){window.matchMedia&&!window.matchMedia("(any-hover: hover)").matches||(this.menu.removeEventListener("mouseleave",this.#i),this.rows.forEach((e=>{e.removeEventListener("mouseenter",this.#s),e.removeEventListener("click",this.#t)})),document.removeEventListener("mousemove",this.#o))}#d(e){this.#u.push({x:e.pageX,y:e.pageY}),this.#u.length>NestedMenu.#h&&this.#u.shift()}#l(){this.#c&&clearTimeout(this.#c),this.#v(this.#e,NestedMenu.#a)}#r(e){this.#c&&clearTimeout(this.#c),this.#b(e.target)}#m(e){this.activate(e.target)}static openSubmenu(e){if(!e)return;const t=e.querySelector("header-details-disclosure");t&&t.mouseEnterListener()}static closeSubmenu(e){if(!e)return;const t=e.querySelector("header-details-disclosure");t&&t.mouseLeaveListener()}activate(e){e!==this.#e&&(this.#e&&NestedMenu.closeSubmenu(this.#e),NestedMenu.openSubmenu(e),this.#e=e)}#b(e){const t=this.#w();t?this.#c=setTimeout((()=>{this.#b(e)}),t):this.activate(e)}#v(e,t){const s=t??this.#w();s?this.#c=setTimeout((()=>{this.#v(e)}),s):(NestedMenu.closeSubmenu(e),this.#e=null)}#w(){if(!this.#e||!this.rows.includes(this.#e))return 0;const e={top:this.menu.getBoundingClientRect().top+window.scrollY,left:this.menu.getBoundingClientRect().left+window.scrollX},t={x:e.left,y:e.top-this.tolerance},s={x:e.left+this.menu.offsetWidth,y:t.y},i={x:e.left,y:e.top+this.menu.offsetHeight+this.tolerance},o={x:e.left+this.menu.offsetWidth,y:i.y},n=this.#u[this.#u.length-1];let u=this.#u[0];if(!n)return 0;if(u||(u=n),u.x<e.left||u.x>o.x||u.y<e.top||u.y>o.y)return 0;if(this.#n&&n.x===this.#n.x&&n.y===this.#n.y)return 0;function c(e,t){return(t.y-e.y)/(t.x-e.x)}let h=s,a=o;"left"===this.submenuDirection?(h=i,a=t):"below"===this.submenuDirection&&(h=o,a=i);const l=c(n,h),r=c(n,a),m=c(u,h),d=c(u,a);return l<m&&r>d?(this.#n=n,NestedMenu.#a):(this.#n=null,0)}}customElements.define("nested-menu",NestedMenu);
//# sourceMappingURL=nested-menu.js.map
