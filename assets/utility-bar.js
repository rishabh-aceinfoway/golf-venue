class UtilityBar extends HTMLElement{connectedCallback(){this.id=this.getAttribute("id"),this.carouselContainer=this.querySelector(".utility-announcement"),this.carouselWrapper=this.querySelector(".utility-announcement__wrapper"),this.carouselSlides=this.querySelectorAll(".utility-announcement__slides"),null!=this.carouselContainer&&(this.interactions=!0,this.autoplay=this.carouselContainer.hasAttribute("autoplay"),this.autoplayDelay=Number(this.carouselContainer.getAttribute("autoplay-delay")||"5000"),this.currentSlide=0,this.autoplayInterval=null,this.carouselSlides.length>1&&this.#e(),this.intersectionObserver=new IntersectionObserver(this.handleIntersection.bind(this)),this.mutationObserver=new MutationObserver((()=>{this.handleWindowResize()})),this.handleWindowResize(),window.addEventListener("resize",(()=>{this.handleWindowResize()})),this.observeMutations(),this.carouselSlides[this.currentSlide].dataset.active=!0,this.autoplay&&(this.startAutoplay(),this.carouselContainer.addEventListener("mouseenter",(()=>this.stopAutoplay())),this.carouselContainer.addEventListener("mouseleave",(()=>{this.hasAttribute("popup-open")||this.startAutoplay()}))),this.observeSlides()),this.setAttribute("loaded","")}observeMutations(){this.mutationObserver.observe(this.carouselWrapper,{childList:!0,subtree:!0,characterData:!0})}observeSlides(){this.carouselSlides.forEach((e=>{this.intersectionObserver.observe(e)}))}handleWindowResize(){this.#t()}handleScroll(){const e=this.carouselSlides[0].getBoundingClientRect().width;this.currentSlide=Math.round(this.carouselWrapper.scrollLeft/e),this.carouselSlides.forEach(((e,t)=>{t===this.currentSlide?e.setAttribute("data-active",""):e.removeAttribute("data-active")}))}handleIntersection(e){e.forEach((e=>{e.isIntersecting?this.carouselWrapper.addEventListener("scroll",(()=>this.handleScroll())):this.carouselWrapper.removeEventListener("scroll",(()=>this.handleScroll()))}))}disconnectedCallback(){this.staticDisplay||(this.stopAutoplay(),this.carouselPrevBtn?.removeEventListener("click",this.showPrevSlide),this.carouselNextBtn?.removeEventListener("click",this.showNextSlide),this.carouselContainer.removeEventListener("mouseenter",this.stopAutoplay),this.carouselContainer.removeEventListener("mouseleave",this.startAutoplay),this.intersectionObserver.disconnect(),this.textSizeObserver.disconnect()),this.mutationObserver.disconnect(),window.removeEventListener("resize",this.handleWindowResize),this.removeAttribute("loaded")}showPrevSlide(){0===this.currentSlide?this.moveToSlide(this.carouselSlides.length-1):this.moveToSlide(this.currentSlide-1),this.dispatchEvent(new CustomEvent("on:announcement-bar:slide-change",{detail:{currentSlide:this.currentSlide}}))}showNextSlide(){this.currentSlide===this.carouselSlides.length-1?this.moveToSlide(0):this.moveToSlide(this.currentSlide+1),this.dispatchEvent(new CustomEvent("on:announcement-bar:slide-change",{detail:{currentSlide:this.currentSlide}}))}startAutoplay(){this.interactions&&null===this.autoplayInterval&&(this.setAttribute("scrolling",""),this.autoplayInterval=setInterval((()=>{this.showNextSlide()}),this.autoplayDelay))}stopAutoplay(){this.interactions&&null!==this.autoplayInterval&&(this.removeAttribute("scrolling"),clearInterval(this.autoplayInterval),this.autoplayInterval=null)}moveToSlide(e,t="smooth"){this.carouselWrapper.scrollTo({left:this.carouselSlides[e].offsetLeft,behavior:window.matchMedia("(prefers-reduced-motion: reduce)").matches?"instant":t}),this.currentSlide=e,this.carouselSlides.forEach(((e,t)=>{t===this.currentSlide?e.setAttribute("data-active",""):e.removeAttribute("data-active")}))}stopInteractions(){this.interactions=!1}resumeInteractions(){this.interactions=!0}#t(){this.slidesWidth=0,this.containerWidth=.89*window.innerWidth;const{carouselSlides:e}=this;e.forEach((e=>{const t=e.querySelector(".utility-announcement__message"),i=e.querySelector(".utility-announcement__text"),s=window.getComputedStyle(t),n=i.offsetWidth+parseFloat(s.paddingLeft)+parseFloat(s.paddingRight);this.slidesWidth+=n})),this.slidesWrap=this.slidesWidth>this.containerWidth}#e(){this.carouselPrevBtn=document.createElement("button"),this.carouselPrevBtn.classList.add("utility-announcement__carousel-button","carousel-prev"),this.carouselPrevBtn.setAttribute("aria-label","Previous Announcement");const e=document.getElementById("template-icon-chevron").content.cloneNode(!0).firstElementChild;e.classList.add("icon--left"),this.carouselPrevBtn.append(e),this.carouselContainer.prepend(this.carouselPrevBtn),this.carouselNextBtn=document.createElement("button"),this.carouselNextBtn.classList.add("utility-announcement__carousel-button","carousel-next"),this.carouselNextBtn.setAttribute("aria-label","Next Announcement");const t=document.getElementById("template-icon-chevron").content.cloneNode(!0).firstElementChild;this.carouselNextBtn.append(t),this.carouselContainer.append(this.carouselNextBtn),this.carouselPrevBtn.addEventListener("click",(()=>this.showPrevSlide())),this.carouselNextBtn.addEventListener("click",(()=>this.showNextSlide()))}}customElements.define("utility-bar",UtilityBar);
//# sourceMappingURL=utility-bar.js.map
