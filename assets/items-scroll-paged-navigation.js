import{debounce}from"utils";import ItemsScroll from"items-scroll";class ItemsScrollPagedNavigation extends ItemsScroll{#t;#i;#e;#a=!1;#n;#s;#o;#r=!1;constructor(){super(),this.pageNavigationWrapper=null,this.navigationCounterOnly=this.hasAttribute("mobile-counter-only"),this.navigationCounterSeparator="/",this.navigationCounterShowForPagesAmount=7,this.navigationCounterShowUpToContainerSize=768,this.#t=this.#g.bind(this),this.#i=this.#h.bind(this),this.#e=this.#l.bind(this)}connectedCallback(){super.connectedCallback(),this.#v(),this.#o=new ResizeObserver(debounce((()=>{this.#c()})),50),this.#o.observe(this.items),this.addEventListener("on:items-scroll:change-state",this.#i),this.pageNavigationContainer&&this.pageNavigationContainer.addEventListener("click",this.#l.bind(this))}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("on:items-scroll:change-state",this.#i),this.#o&&(this.#o.disconnect(),this.#o=null),this.#d()}#p(){this.#a||(this.items.addEventListener("scroll",this.#t),this.pageNavigationContainer&&this.pageNavigationContainer.addEventListener("click",this.#e),this.#a=!0)}#d(){this.#a&&(this.items.removeEventListener("scroll",this.#t),this.pageNavigationContainer&&this.pageNavigationContainer.removeEventListener("click",this.#e),this.#a=!1)}#c(){this.pageNavigationWrapper||(this.pageNavigationWrapper=document.createElement("div"),this.pageNavigationWrapper.classList.add("page-navigation-wrapper"),this.appendChild(this.pageNavigationWrapper));const t=Math.ceil(this.items.children.length/this.itemsPerPage);t!==this.#s&&(this.#s=t,this.navigationCounterShowUpToContainerSize&&this.navigationCounterShowUpToContainerSize>=this.offsetWidth&&this.navigationCounterShowForPagesAmount&&(this.navigationCounterOnly||this.#s>=this.navigationCounterShowForPagesAmount)?(this.pageNavigationContainer&&this.pageNavigationContainer.setAttribute("hidden",!0),this.pageNavigationCounter||(this.pageNavigationCounter=document.createElement("div"),this.pageNavigationCounter.classList.add("page-navigation-counter"),this.pageNavigationWrapper.appendChild(this.pageNavigationCounter)),this.pageNavigationCounter.removeAttribute("hidden"),this.pageNavigationCounter.innerHTML=`\n          <span class="page-navigation-counter__current">${this.#n||1}</span>\n          <span class="page-navigation-counter__separator">${this.navigationCounterSeparator}</span>\n          <span class="page-navigation-counter__total">${this.#s}</span>\n        `,this.#v()):(this.pageNavigationCounter&&this.pageNavigationCounter.setAttribute("hidden",!0),this.pageNavigationContainer||(this.pageNavigationContainer=document.createElement("ul"),this.pageNavigationContainer.classList.add("page-navigation"),this.pageNavigationContainer.setAttribute("role","tablist"),this.pageNavigationWrapper.appendChild(this.pageNavigationContainer)),this.pageNavigationContainer.removeAttribute("hidden"),this.#s>1?(this.pageNavigationContainer.innerHTML=`\n            ${Array.from({length:t},((t,i)=>`\n              <li class="page-navigation__item" role="presentation">\n                <button type="button" role="tab" class="page-navigation__button" data-page="${i+1}" aria-label="Scroll to page ${i+1} of ${this.#s}" tabindex="-1">\n                  <span class="visually-hidden">${i+1}</span>\n                </button>\n              </li>\n            `)).join("\n")}\n          `,this.#v()):this.pageNavigationContainer.innerHTML=""))}#h({detail:{scrollable:t}}){t?(this.#c(),this.#p()):this.pageNavigationContainer&&this.#d()}#l(t){const{target:i}=t;if(!i.classList.contains("page-navigation__button"))return;const e=Number(i.dataset.page);this.#u(this.items.children[this.itemsPerPage*(e-1)].offsetLeft,"smooth")}#v(){if(this.pageNavigationDisabled)return;if(!this.#s||!this.#s>1)return;const{itemAtScroll:t}=this,i=[...this.items.children].indexOf(t);this.#n=i;const e=this.#n+this.itemsPerPage>this.items.children.length-1?this.#s-1:Math.floor(i/this.itemsPerPage);if(this.pageNavigationContainer&&(this.pageNavigationContainer.querySelector(".is-active")&&this.pageNavigationContainer.querySelector(".is-active").classList.remove("is-active"),this.pageNavigationContainer.children[e]&&this.pageNavigationContainer.children[e].querySelector("button").classList.add("is-active")),this.pageNavigationCounter){const t=this.pageNavigationCounter.querySelector(".page-navigation-counter__current");this.pageNavigationCounter.setAttribute("aria-label",`Page ${e+1} of ${this.#s}`),t&&(t.innerHTML=e+1)}}#g(){this.pageNavigationDisabled||this.#r||(window.requestAnimationFrame((()=>{this.#v(),this.#r=!1})),this.#r=!0)}#u(t,i="instant"){let e=t;e<0?e=0:e>this.items.scrollWidth-this.items.offsetWidth&&(e=this.items.scrollWidth-this.items.offsetWidth),"instant"===i?this.items.scrollTo({behavior:"instant",left:e}):this.smoothScrollItems(e)}}customElements.define("items-scroll-paged-navigation",ItemsScrollPagedNavigation);
//# sourceMappingURL=items-scroll-paged-navigation.js.map
